config:
  limits.cpu: "2"
  limits.memory: "512MB"    
  linux.kernel_modules: nf_nat
  user.network-config: |
    version: 1
    config:      

      # initial mgmt interface for bootstrapping.
      - type: physical
        name: eth0
        subnets:
          - type: dhcp
            ipv4: true
            control: auto

      # untrusted outside; gets IP via DHCP run by upstream gateway
      - type: physical
        name: eth1
        subnets:
          - type: dhcp
            ipv4: true
            control: auto

      # inside underlay network -- data path, where we forward incoming DHCP and DNS requests
      # to lxdbrUndLANsvcs and act as a gateway for underlay hosts.
      - type: physical
        name: eth2
        subnets:
          - type: static
            ipv4: true
            address: 192.168.0.1
            netmask: 255.255.255.0
            control: auto

description:
devices:

  # Used for management and initial downloading of software
  eth0:
    nictype: bridged
    parent: lxdbrUnderlay
    type: nic

  # physical access to untrusted outside
  eth1:
    nictype: physical
    parent: eno1
    type: nic

  # physical access to trusted inside where we run DHCP, etc.
  eth2:
    nictype: physical
    parent: eno1
    type: nic

  root:
    path: /
    pool: bcm_data
    type: disk

name: underlay_lxd_profile.yml